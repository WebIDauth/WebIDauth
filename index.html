<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>

  <title>WebIDauth/WebIDauth @ GitHub</title>

  <style type="text/css">
    body {
      margin-top: 1.0em;
      background-color: #7baad1;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    #container {
      margin: 0 auto;
      width: 700px;
    }
    h1 { font-size: 3.8em; color: #84552e; margin-bottom: 3px; }
    h1 .small { font-size: 0.4em; }
    h1 a { text-decoration: none }
    h2 { font-size: 1.5em; color: #84552e; }
    h3 { text-align: center; color: #84552e; }
    a { color: #84552e; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
    pre { background: #000; color: #fff; padding: 15px;}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .footer { text-align:center; padding-top:30px; font-style: italic; }
  </style>
</head>

<body>
  <a href="http://github.com/WebIDauth/WebIDauth"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>

  <div id="container">

    <div class="download">
      <a href="http://github.com/WebIDauth/WebIDauth/zipball/master">
        <img border="0" width="90" src="http://github.com/images/modules/download/zip.png"></a>
      <a href="http://github.com/WebIDauth/WebIDauth/tarball/master">
        <img border="0" width="90" src="http://github.com/images/modules/download/tar.png"></a>
    </div>

    <h1><a href="http://github.com/WebIDauth/WebIDauth">WebIDauth</a>
      <span class="small">by <a href="http://github.com/WebIDauth">WebIDauth</a></span></h1>

    <div class="description">
      WebIDauth is a PHP authentication service for <a href="http://www.w3.org/wiki/WebID">WebID</a> enabled <a href="http://www.foaf-project.org/">FOAF</a> profiles, aiming to provide a service s    imilar to <a href="https://foafssl.org/srv/idp">foafssl.org</a>. This library is currently powering auth.fcns.eu.
    </div>

<br/><br/><strong>Functionalities</strong><br/><br/>

 <p>Right now, WebIDauth supports the following functionalities:<br/>
<ul>
<li>if you select 'Display certificate instead of authenticating?' you can see the contents of the certificate you are using to connect to this site</li>
<li>checks if the SubjectAltName filed contains something else other than the webid uri, and only processeses the URI:</li>
<li>checks if the webid profile contains multiple values for modulus (e.g. multiple public keys) and cycles through them until it gets a match</li>
</ul><br/>
<strong>How it works</strong><br/></p>

If you are fairly familiar with how foafssl.org works, then you will immediately understand how WebIDauth works.

For example, the website <i>http://webid.fcns.eu/</i> could have a "Login" link on the main page to allow users to authenticate using their webids. This link points to a server which is runnin    g WebIDauth, let's say <i>https://auth.fcns.eu/</i> and which we will call IdP (Identity Provider) from now on. A typical link would look something like this:<br/><br/>
<tt>https://auth.fcns.eu/auth/index.php?authreqissuer=https://webid.fcns.eu/index.php</tt><br/><br/>

What happens next is the IdP will demand a certificate from the browser. From the certificate it will extract the webid URI, then after fetching the foaf profile located at that specific URI it will attempt to match the public key of the certificate with the data found in the foaf profile.

If the two match, it will then redirect the user back to the page contained in the authreqissuer variable (the service at http://webid.fcns.eu/), appending several variables. Following the model from foafssl.org, the new URL will look like this:<br/>
<b>$authreqissuer?webid=$webid&ts=$timeStamp</b>&sig=$URLSignature&referrer=$referer<br/><br/>

Where the above variables have the following meanings:<br/>
<ul>
<li><tt>$authreqissuer</tt> is the URL passed by the server in the initial request.</li>
<li><tt>$webid</tt> is the WebID of the user connecting.</li>
<li><tt>$timeStamp</tt> is a time stamp in XML Schema format. This timestamp protects against replay attacks.</li>
<li><tt>$URLSignature</tt> is the signature of the whole URL in bold above.</li>
<li><tt>$referer</tt> is the address of the IdP. (might be needed to fetch the public key of the IdP\'s SSL certificate)</li>
</ul>

<strong>Error responses</strong><br/><br/>

In case of error the service gets redirected to the following URL: $authreqissuer?error=$code, where $code can be either one of:<br/>
<ul>
<li><tt>nocert</tt>: No certificates installed in the clientâ€™s browser.</li>
<li><tt>certExpired</tt>: The certificate has expired</li>
<li><tt>noVerifiedWebId</tt>: WebId does not match the certificate.</li>
<li><tt>noWebId</tt>: No identity found for existing WebID.</li>
<li><tt>IdPError</tt>: Other error(s) in the IdP setup. Please warn the IdP administrator.</li>
</ul>

<h2>Dependencies</h2>
<p>PHP, OpenSSL, Apache's mod_ssl</p>
<h2>Install</h2>
<p>1. Simply copy the all the contents to your public web directory.
2. Make sure Apache's mod_ssl is enabled on your webserver.
3. Edit file 'index.php' and replace the $server_key variable to use your server's private key. You may also change the temporary directory to some other location than the default one.
4. Save everything and start authenticating users by having them click a link similar to this one:
https://<your webserver's url>/index.php?authreqissuer=<url of the site into which you want to login></p>
<h2>License</h2>
<p>GNU Affero General Public License</p>
<h2>Authors</h2>
<p>Andrei Sambra </p>
<h2>Contact</h2>
<p>Author (auth@fcns.eu)
<br/>      </p>


    <h2>Download</h2>
    <p>
      You can download this project in either
      <a href="http://github.com/WebIDauth/WebIDauth/zipball/master">zip</a> or
      <a href="http://github.com/WebIDauth/WebIDauth/tarball/master">tar</a> formats.
    </p>
    <p>You can also clone the project with <a href="http://git-scm.com">Git</a>
      by running:
      <pre>$ git clone git://github.com/WebIDauth/WebIDauth</pre>
    </p>

    <div class="footer">
      get the source code on GitHub : <a href="http://github.com/WebIDauth/WebIDauth">WebIDauth/WebIDauth</a>
    </div>

  </div>

  <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-2605982-14");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
